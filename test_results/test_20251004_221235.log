[2025-10-04 22:12:35] 🚀 Starting Network Automation Test Pipeline
[2025-10-04 22:12:35] 🧪 Testing Ansible inventory...
[WARNING]: Invalid characters were found in group names but not replaced, use
-vvvv to see details
[WARNING]: Found variable using reserved name: tags
[WARNING]: Found variable using reserved name: serial
{
    "_meta": {
        "hostvars": {
            "Router-1": {
                "ansible_host": "R1",
                "ansible_network_os": "linux",
                "ansible_password": "cisco123",
                "ansible_user": "root",
                "backup_retention_days": 30,
                "backup_server": "{{ vault_backup_server_credentials }}",
                "bgp_asn": "65001",
                "config_backup_enabled": true,
                "device_roles": [
                    "router"
                ],
                "device_types": [
                    "ios-router"
                ],
                "is_virtual": false,
                "local_context_data": [
                    null
                ],
                "locations": [],
                "loopback_ip": "1.1.1.1/32",
                "manufacturers": [
                    "cisco"
                ],
                "netbox_api_token": "{{ vault_netbox_api_token }}",
                "netbox_url": "http://localhost:8000",
                "ntp_auth_key": "{{ vault_ntp_auth_key }}",
                "ospf_area": "0",
                "ospf_router_id": "1.1.1.1",
                "regions": [],
                "serial": "",
                "services": [],
                "site_groups": [],
                "sites": [
                    "demo-site"
                ],
                "snmp_community": "{{ vault_snmp_community }}",
                "software_version": "FRRouting 8.4_git (6ea8ad54aa6d) on Linux(6.10.14-linuxkit).",
                "status": {
                    "label": "Active",
                    "value": "active"
                },
                "syslog_server": "{{ vault_syslog_server }}",
                "tags": [],
                "vault_ansible_password": "secure_password",
                "vault_ansible_user": "admin",
                "vault_netbox_api_token": "c316eac1941ee8fdd5059e4f9e777648459ab551",
                "vault_netbox_url": "http://localhost:8000",
                "vault_ntp_servers": [
                    "pool.ntp.org",
                    "time.google.com"
                ],
                "vault_snmp_community": "private"
            },
            "Router-2": {
                "ansible_host": "R2",
                "ansible_network_os": "linux",
                "ansible_password": "cisco123",
                "ansible_user": "root",
                "backup_retention_days": 30,
                "backup_server": "{{ vault_backup_server_credentials }}",
                "bgp_asn": "65002",
                "config_backup_enabled": true,
                "device_roles": [
                    "router"
                ],
                "device_types": [
                    "ios-router"
                ],
                "is_virtual": false,
                "local_context_data": [
                    null
                ],
                "locations": [],
                "loopback_ip": "2.2.2.2/32",
                "manufacturers": [
                    "cisco"
                ],
                "netbox_api_token": "{{ vault_netbox_api_token }}",
                "netbox_url": "http://localhost:8000",
                "ntp_auth_key": "{{ vault_ntp_auth_key }}",
                "ospf_area": "0",
                "ospf_router_id": "2.2.2.2",
                "regions": [],
                "serial": "",
                "services": [],
                "site_groups": [],
                "sites": [
                    "demo-site"
                ],
                "snmp_community": "{{ vault_snmp_community }}",
                "software_version": "FRRouting 8.4_git (bb0257865180) on Linux(6.10.14-linuxkit).",
                "status": {
                    "label": "Active",
                    "value": "active"
                },
                "syslog_server": "{{ vault_syslog_server }}",
                "tags": [],
                "vault_ansible_password": "secure_password",
                "vault_ansible_user": "admin",
                "vault_netbox_api_token": "c316eac1941ee8fdd5059e4f9e777648459ab551",
                "vault_netbox_url": "http://localhost:8000",
                "vault_ntp_servers": [
                    "pool.ntp.org",
                    "time.google.com"
                ],
                "vault_snmp_community": "private"
            },
            "Router-3": {
                "ansible_host": "R3",
                "ansible_network_os": "linux",
                "ansible_password": "cisco123",
                "ansible_user": "root",
                "backup_retention_days": 30,
                "backup_server": "{{ vault_backup_server_credentials }}",
                "bgp_asn": "65003",
                "config_backup_enabled": true,
                "device_roles": [
                    "router"
                ],
                "device_types": [
                    "ios-router"
                ],
                "is_virtual": false,
                "local_context_data": [
                    null
                ],
                "locations": [],
                "loopback_ip": "3.3.3.3/32",
                "manufacturers": [
                    "cisco"
                ],
                "netbox_api_token": "{{ vault_netbox_api_token }}",
                "netbox_url": "http://localhost:8000",
                "ntp_auth_key": "{{ vault_ntp_auth_key }}",
                "ospf_area": "0",
                "ospf_router_id": "3.3.3.3",
                "regions": [],
                "serial": "",
                "services": [],
                "site_groups": [],
                "sites": [
                    "demo-site"
                ],
                "snmp_community": "{{ vault_snmp_community }}",
                "software_version": "FRRouting 8.4_git (671ccc71dc0b) on Linux(6.10.14-linuxkit).",
                "status": {
                    "label": "Active",
                    "value": "active"
                },
                "syslog_server": "{{ vault_syslog_server }}",
                "tags": [],
                "vault_ansible_password": "secure_password",
                "vault_ansible_user": "admin",
                "vault_netbox_api_token": "c316eac1941ee8fdd5059e4f9e777648459ab551",
                "vault_netbox_url": "http://localhost:8000",
                "vault_ntp_servers": [
                    "pool.ntp.org",
                    "time.google.com"
                ],
                "vault_snmp_community": "private"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "sites_demo-site",
            "device_roles_router"
        ]
    },
    "device_roles_router": {
        "hosts": [
            "Router-1",
            "Router-2",
            "Router-3"
        ]
    },
    "sites_demo-site": {
        "hosts": [
            "Router-1",
            "Router-2",
            "Router-3"
        ]
    }
}
[2025-10-04 22:12:36] ✅ Ansible inventory passed
[2025-10-04 22:12:36] 🔗 Testing device connectivity...
[2025-10-04 22:12:38] ⚠️ Direct connectivity failed, containers may be down
[2025-10-04 22:12:38] 🧪 Testing Backup playbook...
[WARNING]: Invalid characters were found in group names but not replaced, use
-vvvv to see details
[WARNING]: Found variable using reserved name: serial
[WARNING]: Found variable using reserved name: tags

PLAY [Backup device configurations] ********************************************

TASK [Gathering Facts] *********************************************************
An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
fatal: [Router-1]: FAILED! => {"changed": false, "msg": "No fact modules available and we could not find a fact module for your network OS (linux), try setting one via the `FACTS_MODULES` configuration."}
An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
fatal: [Router-2]: FAILED! => {"changed": false, "msg": "No fact modules available and we could not find a fact module for your network OS (linux), try setting one via the `FACTS_MODULES` configuration."}
An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
fatal: [Router-3]: FAILED! => {"changed": false, "msg": "No fact modules available and we could not find a fact module for your network OS (linux), try setting one via the `FACTS_MODULES` configuration."}

PLAY RECAP *********************************************************************
Router-1                   : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
Router-2                   : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
Router-3                   : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   

[2025-10-04 22:12:41] [ERROR] ❌ Backup playbook failed
[2025-10-04 22:12:41] 🧪 Testing Configuration push...
[WARNING]: Invalid characters were found in group names but not replaced, use
-vvvv to see details
[WARNING]: Found variable using reserved name: serial
[WARNING]: Found variable using reserved name: tags

PLAY [Push Configurations from NetBox to Devices] ******************************

TASK [Backup current config before changes] ************************************
skipping: [Router-1]
skipping: [Router-2]
skipping: [Router-3]

TASK [Skip backup in check mode] ***********************************************
ok: [Router-1] => {
    "msg": "Backup skipped in check mode for Router-1"
}
ok: [Router-2] => {
    "msg": "Backup skipped in check mode for Router-2"
}
ok: [Router-3] => {
    "msg": "Backup skipped in check mode for Router-3"
}

TASK [Generate config from template] *******************************************
changed: [Router-2 -> localhost]
changed: [Router-1 -> localhost]
changed: [Router-3 -> localhost]

TASK [Display generated config] ************************************************
ok: [Router-1] => {
    "msg": "Generated config for Router-1"
}
ok: [Router-2] => {
    "msg": "Generated config for Router-2"
}
ok: [Router-3] => {
    "msg": "Generated config for Router-3"
}

TASK [Show configuration preview (check mode)] *********************************
ok: [Router-1] => {
    "msg": "Configuration Preview for Router-1:\n- BGP ASN: 65001\n- Loopback IP: 1.1.1.1/32\n- OSPF Router ID: 1.1.1.1\n- OSPF Area: 0\n- Config file: /tmp/Router-1_new_config.conf\n"
}
ok: [Router-2] => {
    "msg": "Configuration Preview for Router-2:\n- BGP ASN: 65002\n- Loopback IP: 2.2.2.2/32\n- OSPF Router ID: 2.2.2.2\n- OSPF Area: 0\n- Config file: /tmp/Router-2_new_config.conf\n"
}
ok: [Router-3] => {
    "msg": "Configuration Preview for Router-3:\n- BGP ASN: 65003\n- Loopback IP: 3.3.3.3/32\n- OSPF Router ID: 3.3.3.3\n- OSPF Area: 0\n- Config file: /tmp/Router-3_new_config.conf\n"
}

TASK [Apply configuration to device (non-check mode)] **************************
skipping: [Router-1]
skipping: [Router-2]
skipping: [Router-3]

TASK [Display deployment status] ***********************************************
ok: [Router-1] => {
    "msg": "Deployment Status for Router-1:\n- Mode: CHECK MODE - No changes made\n- Configuration validated and generated successfully\n"
}
ok: [Router-2] => {
    "msg": "Deployment Status for Router-2:\n- Mode: CHECK MODE - No changes made\n- Configuration validated and generated successfully\n"
}
ok: [Router-3] => {
    "msg": "Deployment Status for Router-3:\n- Mode: CHECK MODE - No changes made\n- Configuration validated and generated successfully\n"
}

PLAY RECAP *********************************************************************
Router-1                   : ok=5    changed=1    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
Router-2                   : ok=5    changed=1    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
Router-3                   : ok=5    changed=1    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   

[2025-10-04 22:12:42] ✅ Configuration push passed
[2025-10-04 22:12:42] 🧪 Testing Facts collection...
[WARNING]: Invalid characters were found in group names but not replaced, use
-vvvv to see details
[WARNING]: Found variable using reserved name: tags
[WARNING]: Found variable using reserved name: serial

PLAY [Collect FRR device facts] ************************************************

TASK [Gathering Facts] *********************************************************
An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
fatal: [Router-1]: FAILED! => {"changed": false, "msg": "No fact modules available and we could not find a fact module for your network OS (linux), try setting one via the `FACTS_MODULES` configuration."}
An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
fatal: [Router-2]: FAILED! => {"changed": false, "msg": "No fact modules available and we could not find a fact module for your network OS (linux), try setting one via the `FACTS_MODULES` configuration."}
An exception occurred during task execution. To see the full traceback, use -vvv. The error was: NoneType: None
fatal: [Router-3]: FAILED! => {"changed": false, "msg": "No fact modules available and we could not find a fact module for your network OS (linux), try setting one via the `FACTS_MODULES` configuration."}

PLAY RECAP *********************************************************************
Router-1                   : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
Router-2                   : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
Router-3                   : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   

[2025-10-04 22:12:43] [ERROR] ❌ Facts collection failed
[2025-10-04 22:12:43] 🔄 Testing NetBox synchronization...
2025-10-04 22:12:43,610 - INFO - Step 1: Loading device facts...
2025-10-04 22:12:43,610 - INFO - Loading device facts from JSON files...
2025-10-04 22:12:43,611 - INFO - Loaded facts for Router-1
2025-10-04 22:12:43,611 - INFO - Loaded facts for Router-3
2025-10-04 22:12:43,612 - INFO - Loaded facts for Router-2
2025-10-04 22:12:43,612 - INFO - Step 2: Connecting to NetBox...
2025-10-04 22:12:43,612 - INFO - Retrieving current NetBox data...
2025-10-04 22:12:43,722 - INFO - Retrieved NetBox data for 3 devices
============================================================
NetBox Source of Truth Round-Trip Sync
============================================================
Started at: 2025-10-04 22:12:43
✅ Loaded facts from 3 devices
✅ Retrieved NetBox data for 3 devices
✅ NetBox sync test completed
[2025-10-04 22:12:43] ✅ NetBox sync test passed
[2025-10-04 22:12:43] ⚡ Running performance benchmarks...
[2025-10-04 22:12:45] 📈 Pipeline benchmark: 2s
[2025-10-04 22:12:45] 📋 Generating test report...
[2025-10-04 22:12:45] 📋 Test report generated: /Users/swarnimrajput/Netmind/test_results/test_report.html
[2025-10-04 22:12:45] [ERROR] ❌ 3 test(s) failed. Check logs for details.
